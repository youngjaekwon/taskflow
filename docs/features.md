# TaskFlow 기능 명세서

## P0 — 핵심

### 인증

| #   | 기능명                   | 설명                                       |
| --- | ------------------------ | ------------------------------------------ |
| 1   | 이메일/비밀번호 회원가입 | 이메일 형식 검증, 비밀번호 강도 규칙 포함  |
| 2   | 로그인                   | JWT 토큰 발급                              |
| 3   | 토큰 리프레시            | 만료된 토큰 갱신                           |
| 4   | 로그아웃                 | 토큰 무효화                                |
| 5   | 내 프로필 조회/수정      | 로그인한 사용자의 프로필 정보 조회 및 수정 |
| 6   | 프로필 아바타 업로드     | 파일 업로드를 통한 프로필 이미지 설정      |
| 7   | 비밀번호 변경            | 기존 비밀번호 확인 후 새 비밀번호로 변경   |
| 8   | 이메일 인증              | 회원가입 시 인증 메일 발송, 링크 클릭으로 이메일 소유 확인 |
| 9   | 비밀번호 초기화          | 이메일 기반 비밀번호 재설정 흐름                           |

### Organization

| #   | 기능명                           | 설명                                      |
| --- | -------------------------------- | ----------------------------------------- |
| 1   | Organization 생성                | 새 Organization 생성                      |
| 2   | Organization 정보 조회/수정      | Organization 상세 정보 조회 및 수정       |
| 3   | Organization 삭제                | owner만 삭제 가능                         |
| 4   | 멤버 초대                        | 이메일 기반 멤버 초대                     |
| 5   | 멤버 역할 변경                   | owner / admin / member 역할 변경          |
| 6   | 멤버 제거                        | Organization에서 멤버 제거                |
| 7   | 멤버 목록 조회                   | Organization 소속 멤버 전체 조회          |
| 8   | 내가 속한 Organization 목록 조회 | 로그인 사용자 기준 소속 Organization 목록 |

### Project

| #   | 기능명                       | 설명                                    |
| --- | ---------------------------- | --------------------------------------- |
| 1   | 프로젝트 생성                | Organization 하위에 프로젝트 생성       |
| 2   | 프로젝트 정보 조회/수정/삭제 | 프로젝트 CRUD                           |
| 3   | 프로젝트 목록 조회           | Organization별 프로젝트 목록            |
| 4   | 프로젝트 멤버 할당           | Organization 멤버 중 프로젝트 멤버 선택 |

### Board & TaskGroup

| #   | 기능명                           | 설명                                                                        |
| --- | -------------------------------- | --------------------------------------------------------------------------- |
| 1   | Board 생성/수정/삭제             | 프로젝트당 복수 Board 지원                                                  |
| 2   | TaskGroup(컬럼) 생성/수정/삭제   | Board 내 컬럼 관리. Task status와 독립적인 시각적 그룹핑                    |
| 3   | TaskGroup 순서 변경              | position 기반 드래그앤드롭                                                  |
| 4   | 기본 Board + TaskGroup 자동 생성 | 프로젝트 생성 시 기본 Board와 TaskGroup(To Do, In Progress, In Review, Done) 자동 생성 |

### Task

| #   | 기능명                              | 설명                                                 |
| --- | ----------------------------------- | ---------------------------------------------------- |
| 1   | Task 생성                           | 제목, 설명, 상태, 우선순위, 담당자, 기한       |
| 2   | Task 수정/삭제                      | Task 정보 수정 및 삭제                               |
| 3   | Task 상태 변경                      | `todo` → `in_progress` → `in_review` → `done`        |
| 4   | Task를 다른 TaskGroup으로 이동      | moveTask mutation                                    |
| 5   | Task 순서 변경                      | 같은 TaskGroup 내 position 변경                      |
| 6   | Task 담당자 지정/변경               | Task에 담당자 할당 및 변경                           |
| 7   | Task 상세 조회                      | Task 단건 상세 정보 조회                             |
| 8   | Task 목록 조회 + 복합 필터링        | 상태, 우선순위, 담당자, 기한 범위, 키워드 검색 |
| 9   | Task 목록 페이지네이션              | Task 목록 페이지네이션 지원                          |

### 인가

| #   | 기능명                             | 설명                                             |
| --- | ---------------------------------- | ------------------------------------------------ |
| 1   | Organization 역할 기반 권한 체크   | owner > admin > member 계층 구조                 |
| 2   | Organization 비소속 유저 접근 차단 | Organization에 속하지 않은 유저의 접근 완전 차단 |
| 3   | Project별 멤버 접근 제한           | Project에 할당된 멤버만 해당 Project 접근 가능   |
| 4   | Task 삭제 권한                     | 생성자 또는 admin 이상만 삭제 가능               |
| 5   | 멤버 역할 변경 권한                | owner/admin만 역할 변경 가능                     |

---

## P1 — 중요

### Comment

| #   | 기능명              | 설명                                     |
| --- | ------------------- | ---------------------------------------- |
| 1   | 댓글 생성/수정/삭제 | Task에 댓글 CRUD                         |
| 2   | 대댓글              | self-referencing (1depth 제한 또는 무한) |
| 3   | 댓글 목록 조회      | 페이지네이션 지원                        |
| 4   | 댓글 권한           | 작성자만 수정/삭제 가능                  |

### Label

| #   | 기능명                 | 설명                                      |
| --- | ---------------------- | ----------------------------------------- |
| 1   | Label 생성/수정/삭제   | Organization 레벨에서 공유되는 Label 관리 |
| 2   | Label 색상 코드 지정   | Label에 색상 코드 할당                    |
| 3   | Task에 Label 추가/제거 | M2M 관계로 Task-Label 연결                |
| 4   | Label로 Task 필터링    | 특정 Label이 할당된 Task 필터링           |

### 파일 첨부

| #   | 기능명              | 설명                                    |
| --- | ------------------- | --------------------------------------- |
| 1   | Task에 파일 첨부    | 이미지, 문서 등 파일 첨부               |
| 2   | 첨부파일 목록 조회  | Task별 첨부파일 목록                    |
| 3   | 첨부파일 삭제       | 첨부파일 삭제                           |
| 4   | 파일 크기/타입 검증 | 업로드 시 파일 크기 및 타입 유효성 검증 |

### Task 통계

| #   | 기능명                      | 설명                    |
| --- | --------------------------- | ----------------------- |
| 1   | 프로젝트별 상태별 Task 개수 | 상태별 Task 수 집계     |
| 2   | 프로젝트 완료율             | done / total 비율       |
| 3   | 우선순위별 분포             | 우선순위별 Task 수 집계 |
| 4   | 기한 초과 Task 수           | overdue Task 수 집계    |
| 5   | 담당자별 Task 수            | 담당자별 Task 수 집계   |

### Activity Log

| #   | 기능명                    | 설명                                                   |
| --- | ------------------------- | ------------------------------------------------------ |
| 1   | 자동 기록                 | Task 생성/상태 변경/담당자 변경/댓글 작성 시 자동 기록 |
| 2   | Activity Log 목록 조회    | Task별, Project별 조회                                 |
| 3   | Activity Log 페이지네이션 | 페이지네이션 지원                                      |

---

## P2 — 보강

### 실시간 알림 (Subscription)

| #   | 기능명              | 설명                                |
| --- | ------------------- | ----------------------------------- |
| 1   | Task 상태 변경 알림 | 상태 변경 시 담당자에게 실시간 알림 |
| 2   | 댓글 알림           | 내 Task에 댓글 달렸을 때 알림       |
| 3   | 멤버 초대 알림      | Organization 초대 시 알림           |
| 4   | 알림 목록 조회      | 알림 리스트 조회                    |
| 5   | 알림 읽음 처리      | 알림 읽음 상태 변경                 |

### 검색 고도화

| #   | 기능명                      | 설명                                          |
| --- | --------------------------- | --------------------------------------------- |
| 1   | Full-text search            | PostgreSQL full-text search (제목 + 설명)     |
| 2   | Trigram 유사도 검색         | 오타 허용 유사도 검색                         |
| 3   | Organization 전체 범위 검색 | Organization 내 모든 Project의 Task 통합 검색 |

### 보안 / 최적화

| #   | 기능명               | 설명                    |
| --- | -------------------- | ----------------------- |
| 1   | Query depth limit    | GraphQL 쿼리 깊이 제한  |
| 2   | Query cost analysis  | 쿼리 비용 분석          |
| 3   | Persisted queries    | 사전 등록된 쿼리만 허용 |
| 4   | Rate limiting        | API 요청 속도 제한      |
| 5   | Middleware           | 요청 로깅, 에러 핸들링  |

### 기타

| #   | 기능명                        | 설명                                      |
| --- | ----------------------------- | ----------------------------------------- |
| 1   | Task 기한 알림                | Celery로 기한 D-1 알림                    |
| 2   | Task 복제                     | 기존 Task 복제 생성                       |
| 3   | Board 템플릿                  | 스프린트 보드, 버그 트래커 보드 등 프리셋 |
| 4   | Organization/Project 아카이브 | soft delete 기반 아카이브                 |
